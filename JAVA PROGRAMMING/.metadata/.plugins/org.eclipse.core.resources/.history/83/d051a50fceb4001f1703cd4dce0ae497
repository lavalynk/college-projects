package FinalProject;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.util.regex.Pattern;

/**
 * Class: VehicleRentalSystem
 * Abstract: This program allows customers to rent up to three vehicles. It collects user inputs,
 * validates them, and calculates the total rental cost.
 * 
 * @author Keith Brock
 * @since 12/07/2024
 * @version 1.0
 */
public class VehicleRentalSystem {

    public static void main(String[] args) {
        System.out.println("Welcome to the Vehicle Rental System!");

        // Gather customer details
        String strCustomerName = ReadStringFromUser("Enter your name: ");
        String strPhoneNumber = ReadStringFromUser("Enter your phone number (XXX-XXX-XXXX or (XXX) XXX-XXXX): ", VehicleRentalSystem::IsValidPhoneNumber);
        String strEmailAddress = ReadStringFromUser("Enter your email address: ", VehicleRentalSystem::IsValidEmailAddress);
        String strPickupDate = ReadStringFromUser("Enter the vehicle pickup date (YYYY-MM-DD): ");
        int intRentalDays = ReadIntegerFromUser("Enter the number of rental days: ");
        int intVehicleCount = ReadIntegerFromUser("Enter the number of vehicles to rent (1-3): ", VehicleRentalSystem::IsValidVehicleNumber);

        // Collect vehicle details and calculate costs
        double dblTotalCost = 0.0;
        for (int intIndex = 1; intIndex <= intVehicleCount; intIndex++) {
            System.out.println("\nVehicle " + intIndex + ":");
            String strVehicleType = ReadStringFromUser("Enter the type of vehicle (Car, Motorbike, Trailer): ");
            float dblPricePerDay = ReadFloatFromUser("Enter the price per day for this vehicle: ");
            double dblCost = dblPricePerDay * intRentalDays;
            dblTotalCost += dblCost;

            System.out.printf("Vehicle %d: %s, Price per day: $%.2f, Total: $%.2f%n", intIndex, strVehicleType, dblPricePerDay, dblCost);
        }

        // Display the total rental price
        System.out.printf("\nCustomer: %s%nPhone: %s%nEmail: %s%nPickup Date: %s%nRental Days: %d%nTotal Rental Price: $%.2f%n",
                strCustomerName, strPhoneNumber, strEmailAddress, strPickupDate, intRentalDays, dblTotalCost);
    }

    /**
     * Name: ReadStringFromUser
     * Abstract: Reads a string from the user.
     * 
     * @param strPrompt The prompt displayed to the user.
     * @return The string input from the user.
     */
    public static String ReadStringFromUser(String strPrompt) {
        System.out.print(strPrompt);
        try {
            BufferedReader burInput = new BufferedReader(new InputStreamReader(System.in));
            return burInput.readLine().trim();
        } catch (Exception excError) {
            System.out.println("Error reading input. Please try again.");
            return ReadStringFromUser(strPrompt);
        }
    }

    /**
     * Name: ReadIntegerFromUser
     * Abstract: Reads an integer from the user.
     * 
     * @param strPrompt The prompt displayed to the user.
     * @return The integer input from the user.
     */
    public static int ReadIntegerFromUser(String strPrompt) {
        int intValue = 0;
        boolean blnValid = false;

        while (!blnValid) {
            try {
                System.out.print(strPrompt);
                BufferedReader burInput = new BufferedReader(new InputStreamReader(System.in));
                intValue = Integer.parseInt(burInput.readLine().trim());
                blnValid = true;
            } catch (Exception excError) {
                System.out.print("Invalid Input! Please try again.\n");
            }
        }

        return intValue;
    }

    /**
     * Name: ReadFloatFromUser
     * Abstract: Reads a float from the user.
     * 
     * @param strPrompt The prompt displayed to the user.
     * @return The float input from the user.
     */
    public static float ReadFloatFromUser(String strPrompt) {
        float dblValue = 0;
        boolean blnValid = false;

        while (!blnValid) {
            try {
                System.out.print(strPrompt);
                BufferedReader burInput = new BufferedReader(new InputStreamReader(System.in));
                dblValue = Float.parseFloat(burInput.readLine().trim());
                blnValid = true;
            } catch (Exception excError) {
                System.out.print("Invalid Input! Please try again.\n");
            }
        }

        return dblValue;
    }

    /**
     * Name: IsValidPhoneNumber
     * Abstract: Validates a phone number in the format XXX-XXX-XXXX or (XXX) XXX-XXXX.
     * 
     * @param strPhoneNumber The phone number to validate.
     * @return True if the phone number is valid; otherwise, false.
     */
    public static boolean IsValidPhoneNumber(String strPhoneNumber) {
        String strRegex = "^(\\(\\d{3}\\) \\d{3}-\\d{4}|\\d{3}-\\d{3}-\\d{4})$";
        return Pattern.matches(strRegex, strPhoneNumber);
    }

    /**
     * Name: IsValidEmailAddress
     * Abstract: Validates an email address with basic rules: starts with a letter, contains '@', and ends with a valid domain.
     * 
     * @param strEmailAddress The email address to validate.
     * @return True if the email address is valid; otherwise, false.
     */
    public static boolean IsValidEmailAddress(String strEmailAddress) {
        String strRegex = "^[a-zA-Z][\\w.-]*@[a-zA-Z]+\\.[a-zA-Z]{2,6}$";
        return Pattern.matches(strRegex, strEmailAddress);
    }

    /**
     * Name: IsValidVehicleNumber
     * Abstract: Validates that the number of vehicles to rent is between 1 and 3.
     * 
     * @param intVehicleCount The number of vehicles to validate.
     * @return True if the number of vehicles is valid; otherwise, false.
     */
    public static boolean IsValidVehicleNumber(int intVehicleCount) {
        return intVehicleCount >= 1 && intVehicleCount <= 3;
    }
}
